default:
  image: python:3.9-slim
  before_script:
    - pip install -r utils/scripts/requirements.txt


stages:
  - ASN1 Reduction
  - ROS Messages
  - Conversion Headers


asn1_reduced_cam:
  stage: ASN1 Reduction
  script:
    - >
      ./utils/scripts/reduceAsn1ToTypeDependencies.py
      -t CAM
      -o utils/asn1/reduced/cam
      utils/asn1/raw/cam_en302637_2/CAM-PDU-Descriptions.asn
      utils/asn1/raw/cam_en302637_2/cdd/ITS-Container.asn


etsi_its_cam_msgs:
  stage: ROS Messages
  script:
    - >
      ./utils/scripts/asn1ToRosMsg.py
      utils/asn1/reduced/cam/CAM-PDU-Descriptions.asn
      utils/asn1/reduced/cam/ITS-Container.asn
      -o etsi_its_msgs/etsi_its_cam_msgs/msg


etsi_its_cam_conversion:
  stage: Conversion Headers
  script:
    - >
      ./utils/scripts/asn1ToConversionHeader.py
      utils/asn1/reduced/cam/CAM-PDU-Descriptions.asn
      utils/asn1/reduced/cam/ITS-Container.asn
      -t cam
      -o etsi_its_conversion/etsi_its_cam_conversion/include/etsi_its_cam_conversion
